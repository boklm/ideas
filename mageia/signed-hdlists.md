Mageia signed hdlists
=====================

Although the packages are signed, the hdlists are currently not signed.
Someone hosting a Mageia mirror could modify them to include old signed
package with a known vulnerability.

An other problem is that the key used to check the packages is downloaded
from the same mirror, when the media is setup.


Signed hdlists
--------------

Currently, genhdlists2 creates a **MD5SUM** file containing hash of
hdlist files. This file is used by urpmi to check the hdlist files
downloaded. MD5 is not a very secure hash algorithm, so it should be
replaced by a **SHA256SUM** file containing sha256 hashes. For compatibility
with older releases, the **MD5SUM** file should still be generated by
genhdlists2, until no distribution using this file is supported.

The **SHA1SUM** and **MD5SUM** files should be signed using the same
key that is used to sign the packages. genhdlists2 should be updated to
add this signature, and urpmi.update to check it.


Signed media.cfg
----------------

The key used to check packages is currently downloaded from the same
mirror where packages are downloaded. This could allow a mirror owner
to update it with a key they control and resign all packages with it.
Also the media.cfg file which list the repositories is not signed too.

The media.cfg file should have an option to set a gpg key ID for each
repository. In that case, the key will not be downloaded from the mirror,
but from a public key server, or a local keyring file.

The media.cfg file should also be signed. The file should be signed with
a key available in a keyring shipped by the distribution. It should also
be possible to create a keyring file in /etc/urpmi to add other trusted
keys.

